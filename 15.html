<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lekcja 15: SPA & Client-Side Pitfalls - Hack & Learn: Web Edition</title>

    <link rel="stylesheet" href="style.css">

    <style>
        /* Akcent: Framework Violet (Modern JS / React vibe) */
        :root {
            --accent: #bb86fc;
            --accent-glow: rgba(187, 134, 252, 0.3);
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <h1>SPA & CLIENT-SIDE</h1>
            <p>MODUÅ 15: React, Vue, JWT Storage i Frontend Routing</p>
        </header>

        <!-- 1. ROUTING VS AUTH -->
        <section>
            <h2>> ROUTING != AUTORYZACJA</h2>
            <p>W tradycyjnym webie, jeÅ›li chciaÅ‚eÅ› wejÅ›Ä‡ na <code>/admin</code>, pytaÅ‚eÅ› serwer. W SPA (Single Page App)
                to <strong>przeglÄ…darka (JavaScript)</strong> decyduje, co widzisz na ekranie.</p>

            <div class="card">
                <h3>ILUZJA BEZPIECZEÅƒSTWA</h3>
                <p>Programista pisze w React:</p>
                <pre><code>{ user.role === 'ADMIN' ? &lt;AdminPanel /&gt; : &lt;AccessDenied /&gt; }</code></pre>

                <p><strong>BÅ‚Ä…d:</strong> Ukrycie komponentu <code>&lt;AdminPanel /&gt;</code> w HTML nic nie daje.
                    Haker moÅ¼e:
                <ol>
                    <li>OdpaliÄ‡ "DevTools" i rÄ™cznie zmieniÄ‡ swojÄ… rolÄ™ w pamiÄ™ci przeglÄ…darki na 'ADMIN'. Zobaczy
                        panel.</li>
                    <li>ZignorowaÄ‡ frontend i uderzyÄ‡ bezpoÅ›rednio w API, z ktÃ³rym ten panel rozmawia (np.
                        <code>POST /api/delete-user</code>).</li>
                </ol>
                </p>
                <p><span class="highlight">ZASADA:</span> Frontend jest <strong>niezaufany</strong> (Untrusted). KaÅ¼da
                    waÅ¼na decyzja o uprawnieniach musi byÄ‡ zduplikowana na Backendzie.</p>
            </div>
        </section>

        <!-- 2. GDZIE TRZYMAÄ† TOKENY -->
        <section>
            <h2>> JWT STORAGE DILEMMA</h2>
            <p>Gdzie bezpiecznie przechowaÄ‡ token JWT po zalogowaniu? To odwieczny dylemat w SPA.</p>

            <div class="card">
                <h3>OPCJA 1: LocalStorage / SessionStorage âŒ</h3>
                <p>Najpopularniejsza i najgorsza metoda.</p>
                <ul>
                    <li><strong>Plus:</strong> Åatwe w uÅ¼yciu dla programisty.</li>
                    <li><strong>Minus:</strong> PeÅ‚na podatnoÅ›Ä‡ na XSS. Dowolny skrypt (nawet zÅ‚oÅ›liwa reklama) moÅ¼e
                        zrobiÄ‡ <code>localStorage.getItem('token')</code> i przejÄ…Ä‡ konto.</li>
                </ul>
            </div>

            <div class="card" style="border-color: var(--success);">
                <h3>OPCJA 2: HttpOnly Cookies âœ…</h3>
                <p>SposÃ³b rekomendowany przez specjalistÃ³w bezpieczeÅ„stwa.</p>
                <ul>
                    <li><strong>Plus:</strong> Ciasteczko <code>HttpOnly</code> jest <strong>niewidoczne</strong> dla
                        JavaScriptu. XSS nie ukradnie tokena.</li>
                    <li><strong>Haczyk:</strong> Przechodzisz na model Cookie, wiÄ™c musisz siÄ™ teraz martwiÄ‡ o
                        <strong>CSRF</strong> (wymagane <code>SameSite=Strict</code>).</li>
                </ul>
            </div>
        </section>

        <!-- 3. XSS W REACT / VUE -->
        <section>
            <h2>> XSS W NOWOCZESNYM WEBIE</h2>
            <p>MÃ³wi siÄ™, Å¼e React/Vue/Angular sÄ… "bezpieczne domyÅ›lnie", bo automatycznie uciekajÄ… (escape) znaki. To
                prawda, ale deweloperzy zawsze znajdÄ… sposÃ³b, by to zepsuÄ‡.</p>

            <div class="card">
                <h3>NIEBEZPIECZNE FUNKCJE (SINKI)</h3>
                <p>JeÅ›li zobaczysz te atrybuty w kodzie ÅºrÃ³dÅ‚owym, szukaj XSS:</p>
                <ul>
                    <li><strong>React:</strong> <code>dangerouslySetInnerHTML</code> (Nazwa mÃ³wi sama za siebie).</li>
                    <li><strong>Vue.js:</strong> <code>v-html</code>.</li>
                    <li><strong>Angular:</strong> <code>[innerHTML]</code>.</li>
                </ul>
                <p><strong>PrzykÅ‚ad ataku:</strong> JeÅ›li wejÅ›cie do tych funkcji nie jest przefiltrowane bibliotekÄ…
                    <code>DOMPurify</code>, payload <code>&lt;img src=x onerror=alert(1)&gt;</code> zadziaÅ‚a jak w 1999
                    roku.</p>
            </div>

            <div class="card">
                <h3>JAVASCRIPT PROTOCOL XSS</h3>
                <p>Frameworki czÄ™sto nie blokujÄ… wpisywania zÅ‚oÅ›liwych linkÃ³w.</p>
                <pre><code><span class="comment">// Kod profilu:</span>
&lt;a href={user.website}&gt;Moja strona&lt;/a&gt;

<span class="comment">// Atak (user podaje jako stronÄ™):</span>
javascript:alert(document.domain)</code></pre>
                <p>JeÅ›li klikniesz w "Moja strona", wykonasz kod JS.</p>
            </div>
        </section>

        <!-- CHECKLIST -->
        <section>
            <h2>CHECKLISTA / RED FLAGS</h2>
            <div class="card checklist-card">
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>Tokeny w LocalStorage:</strong> Odpal F12 -> Application -> LocalStorage. Widzisz
                        `auth_token`? ZgÅ‚oÅ› to jako "Sensitive Data Exposure via XSS".</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>"Gruby" kod JS (Source Mapping):</strong> CzÄ™sto na produkcji zostajÄ… pliki `.js.map`.
                        PozwalajÄ… one odtworzyÄ‡ oryginalny kod aplikacji i znaleÅºÄ‡ ukryte endpointy API.</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>Ceny w koszyku na froncie:</strong> JeÅ›li sklep internetowy przelicza sumÄ™ koszyka w
                        React i wysyÅ‚a gotowÄ… kwotÄ™ do API: "Pobierz od usera 5 PLN" -> Business Logic Flaw.</div>
                </div>
            </div>
        </section>

        <!-- QUIZ -->
        <section id="quiz-section">
            <h2>ğŸ“ WERYFIKACJA WIEDZY</h2>
            <div id="quiz-container"></div>
        </section>

        <footer>
            <p style="text-align: center; margin-top: 50px; color: #555;">&copy; 2026 Hack & Learn: Web Edition | ModuÅ‚
                15</p>
        </footer>
    </div>

    <!-- DANE DO QUIZU -->
    <script>
        const quizData = [
            {
                question: "Dlaczego ukrycie przycisku 'UsuÅ„ uÅ¼ytkownika' w kodzie React/Vue (np. warunkiem if(isAdmin)) nie jest zabezpieczeniem?",
                options: [
                    "Bo React jest wolny.",
                    "PoniewaÅ¼ to kontrola tylko na poziomie interfejsu (Frontend). AtakujÄ…cy moÅ¼e pominÄ…Ä‡ przeglÄ…darkÄ™ i wysÅ‚aÄ‡ Å¼Ä…danie HTTP usuniÄ™cia prosto do API (Backendu).",
                    "PoniewaÅ¼ React uÅ¼ywa Virtual DOM.",
                    "To jest w peÅ‚ni bezpieczne, haker nie kliknie przycisku, ktÃ³rego nie widzi."
                ],
                correct: 1,
                explanation: "Frontend to tylko nakÅ‚adka wizualna, ktÃ³ra uÅ‚atwia Å¼ycie uÅ¼ytkownikowi. BezpieczeÅ„stwo (AuthZ) zawsze MUSI byÄ‡ egzekwowane na serwerze (API)."
            },
            {
                question: "Gdzie najbezpieczniej przechowywaÄ‡ token JWT w aplikacji SPA (Single Page Application)?",
                options: [
                    "W LocalStorage.",
                    "W ciasteczku z flagÄ… HttpOnly i Secure.",
                    "W SessionStorage.",
                    "W zmiennej URL."
                ],
                correct: 1,
                explanation: "Ciasteczko HttpOnly chroni token przed atakami XSS (skrypt nie ma do niego dostÄ™pu). LocalStorage i SessionStorage sÄ… w peÅ‚ni dostÄ™pne dla JavaScriptu."
            },
            {
                type: "scenario",
                question: "JesteÅ› w DevTools na stronie SPA. Zmieniasz w LocalStorage wartoÅ›Ä‡ 'isAdmin' z false na true. Nagle pojawia siÄ™ zakÅ‚adka 'Panel Administracyjny'. Co testujesz jako nastÄ™pne?",
                options: [
                    "Nic, zgÅ‚aszam krytyczny bÅ‚Ä…d.",
                    "Klikam w funkcje panelu (np. 'Pobierz listÄ™ userÃ³w'). JeÅ›li API zwrÃ³ci dane, to mamy krytyczny bÅ‚Ä…d na backendzie (Bypass AuthZ). JeÅ›li API zwrÃ³ci 403, to bÅ‚Ä…d jest tylko wizualny.",
                    "PrÃ³bujÄ™ zrobiÄ‡ SQL Injection.",
                    "RestartujÄ™ komputer."
                ],
                correct: 1,
                explanation: "Samo pokazanie panelu to nie podatnoÅ›Ä‡ (to tylko UI). PrawdziwÄ… podatnoÅ›ciÄ… jest moment, gdy backend ufa, Å¼e skoro widzisz ten panel, to masz do niego prawo."
            },
            {
                question: "Co robi funkcja 'dangerouslySetInnerHTML' w React?",
                options: [
                    "Szyfruje kod HTML.",
                    "Pozwala wstrzyknÄ…Ä‡ surowy kod HTML bezpoÅ›rednio do DOM, co moÅ¼e prowadziÄ‡ do XSS, jeÅ›li dane pochodzÄ… od uÅ¼ytkownika.",
                    "Przyspiesza Å‚adowanie strony.",
                    "Blokuje skrypty zewnÄ™trzne."
                ],
                correct: 1,
                explanation: "Nazwa 'dangerously' ma odstraszaÄ‡. JeÅ›li przekaÅ¼esz tam niezaufane dane (np. komentarz usera) bez sanityzacji, React wykona zÅ‚oÅ›liwy kod."
            },
            {
                question: "Co to sÄ… pliki 'Source Maps' (.js.map) czÄ™sto spotykane w SPA?",
                options: [
                    "Mapy lokalizacji uÅ¼ytkownikÃ³w.",
                    "Pliki konfiguracyjne bazy danych.",
                    "Pliki, ktÃ³re Å‚Ä…czÄ… zminifikowany kod na produkcji z oryginalnym, czytelnym kodem ÅºrÃ³dÅ‚owym. Ich pozostawienie uÅ‚atwia pentesterom analizÄ™ aplikacji.",
                    "Pliki z hasÅ‚ami."
                ],
                correct: 2,
                explanation: "DziÄ™ki Source Maps moÅ¼esz w zakÅ‚adce 'Sources' (F12) zobaczyÄ‡ piÄ™kne drzewo katalogÃ³w, nazwy funkcji i komentarze programistÃ³w, mimo Å¼e kod jest zminifikowany."
            },
            {
                question: "Jaki wektor ataku XSS jest czÄ™sto pomijany w frameworkach JS (React/Vue)?",
                options: [
                    "SQL Injection.",
                    "Wstrzykiwanie tagu <script> (framework to blokuje).",
                    "UÅ¼ycie 'javascript:...' jako wartoÅ›ci atrybutu href w linkach (np. w polu 'Moja strona WWW').",
                    "Wgrywanie obrazkÃ³w."
                ],
                correct: 2,
                explanation: "Frameworki dobrze radzÄ… sobie z uciekaniem tagÃ³w HTML. Ale link `javascript:alert(1)` jest dla nich zwykÅ‚ym linkiem. KlikniÄ™cie go wykonuje kod."
            },
            {
                type: "scenario",
                question: "Sklep internetowy napisany w Vue.js mnoÅ¼y cenÄ™ produktu (100 zÅ‚) przez iloÅ›Ä‡ (2) i wysyÅ‚a do API Å¼Ä…danie zapÅ‚aty: POST /pay z polem {'total': 200}. Co robi haker?",
                options: [
                    "Zmienia kolor koszyka.",
                    "Przechwytuje Å¼Ä…danie i zmienia 'total' na 1 (albo 0). JeÅ›li backend nie przeliczy tego sam na podstawie bazy, haker kupi towar za 1 zÅ‚.",
                    "Kradnie ciasteczka.",
                    "Wylogowuje siÄ™."
                ],
                correct: 1,
                explanation: "To klasyczny Client-Side Logic Flaw. Ceny (i generalnie prawda o systemie) zawsze muszÄ… leÅ¼eÄ‡ na backendzie."
            },
            {
                question: "Czy React.js jest caÅ‚kowicie odporny na XSS?",
                options: [
                    "Tak, React w 100% eliminuje XSS.",
                    "Nie. DomyÅ›lne renderowanie ucieka (escape) wartoÅ›ci, ale zÅ‚e praktyki programistyczne (dangerouslySetInnerHTML, linki JS, bÅ‚Ä™dy w refach) nadal pozwalajÄ… na XSS.",
                    "Tak, pod warunkiem uÅ¼ycia HTTPS.",
                    "Nie, React jest najbardziej podatnym frameworkiem."
                ],
                correct: 1,
                explanation: "Framework robi za programistÄ™ 90% roboty. Te ostatnie 10% (nietypowe renderowanie, przestarzaÅ‚e biblioteki) to miejsce, gdzie rodzÄ… siÄ™ bÅ‚Ä™dy."
            },
            {
                question: "Jak chroniÄ‡ tokeny JWT w localStorage przed XSS (jeÅ›li programista upiera siÄ™ przy tym rozwiÄ…zaniu)?",
                options: [
                    "Nie da siÄ™. JeÅ›li jest XSS, localStorage jest w peÅ‚ni skompromitowane.",
                    "MoÅ¼na je zaszyfrowaÄ‡ hasÅ‚em.",
                    "MoÅ¼na uÅ¼yÄ‡ bazy IndexedDB.",
                    "MoÅ¼na zmieniÄ‡ nazwÄ™ tokena na innÄ…."
                ],
                correct: 0,
                explanation: "To gra o sumie zerowej. JeÅ›li zÅ‚oÅ›liwy kod JS dziaÅ‚a w kontekÅ›cie strony, ma takie same prawa do localStorage jak kod aplikacji. Game over."
            },
            {
                question: "Czym jest 'Frontend Routing'?",
                options: [
                    "Przekierowaniem DNS.",
                    "TechnikÄ… w SPA, gdzie zmiana URL (np. /profile) nie wysyÅ‚a Å¼Ä…dania po nowÄ… stronÄ™ HTML do serwera, lecz wymienia komponenty na ekranie za pomocÄ… JavaScriptu.",
                    "WysyÅ‚aniem danych do routera Wi-Fi.",
                    "Blokowaniem portÃ³w."
                ],
                correct: 1,
                explanation: "To waÅ¼ny koncept. Skoro 'strony' (komponenty) nie sÄ… pobierane z serwera, to backend nie ma pojÄ™cia, na jakiej 'podstronie' jest uÅ¼ytkownik. Backend widzi tylko wywoÅ‚ania API."
            }
        ];
    </script>

    <script src="quiz.js"></script>

</body>

</html>