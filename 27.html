<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lekcja 27: WAF & Monitoring - Hack & Learn</title>
    
    <link rel="stylesheet" href="style.css">

    <style>
        /* Akcent: Sensor Orange (Alerts / Monitoring) */
        :root {
            --accent: #ff3d00;
            --accent-glow: rgba(255, 61, 0, 0.3);
            --log: #00e5ff;
        }
        
        .log-box {
            background: #000;
            border: 1px solid #333;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #ccc;
            overflow-x: auto;
        }
        .log-time { color: #888; }
        .log-ip { color: var(--accent); }
        .log-attack { color: #ff0055; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>WAF & MONITORING</h1>
        <p>MODUÅ 27: Web Application Firewall, Wirtualne Åatanie i Logi</p>
    </header>

    <!-- 1. CZYM JEST WAF? -->
    <section>
        <h2>> WAF: CYFROWY OCHRONIARZ</h2>
        <p>ZwykÅ‚y Firewall sieciowy (warstwa 3/4) blokuje porty i adresy IP. <strong>WAF (Web Application Firewall)</strong> dziaÅ‚a w warstwie 7 (Aplikacji). Rozumie HTTP, czyta parametry URL i ciasteczka.</p>
        
        <div class="card">
            <h3>JAK DZIAÅA WAF? (MODELE)</h3>
            <ul>
                <li><strong>Negative Security Model (Czarna Lista):</strong> "Wpuszczam wszystkich, z wyjÄ…tkiem znanych atakÃ³w". <br><em>Np. Blokuj, jeÅ›li w URL jest `UNION SELECT`.</em></li>
                <li><strong>Positive Security Model (BiaÅ‚a Lista):</strong> "BlokujÄ™ wszystkich, z wyjÄ…tkiem znanych dobrych zapytaÅ„". <br><em>Np. Parametr ID musi byÄ‡ liczbÄ….</em></li>
            </ul>
            <p>Popularne WAFy: <strong>Cloudflare, AWS WAF, ModSecurity</strong>.</p>
        </div>
    </section>

    <!-- 2. WIRTUALNE ÅATANIE -->
    <section>
        <h2>> VIRTUAL PATCHING ğŸ©¹</h2>
        <p>To supermoc Blue Teamu. WyobraÅº sobie, Å¼e znajdujesz krytyczne SQL Injection w piÄ…tek o 17:00. Deweloperzy naprawiÄ… to dopiero w poniedziaÅ‚ek. Co robisz?</p>

        <div class="card">
            <h3>ROZWIÄ„ZANIE</h3>
            <p>WdraÅ¼asz reguÅ‚Ä™ na WAF-ie, ktÃ³ra blokuje konkretny payload atakujÄ…cy ten jeden endpoint.</p>
            <div class="log-box">
                # ReguÅ‚a ModSecurity (uproszczona):<br>
                SecRule ARGS:id "@rx [\d]+'.*" \<br>
                "id:1001,deny,status:403,msg:'Virtual Patch for SQLi'"
            </div>
            <p>BÅ‚Ä…d w kodzie nadal istnieje, ale <strong>nikt nie moÅ¼e do niego dotrzeÄ‡</strong>. KupiÅ‚eÅ› czas.</p>
        </div>
    </section>

    <!-- 3. MONITORING & LOGI -->
    <section>
        <h2>> NIE BÄ„DÅ¹ ÅšLEPY (LOGI)</h2>
        <p>Najgorszy atak to ten, o ktÃ³rym nie wiesz. Musisz wiedzieÄ‡, jak wyglÄ…dajÄ… Å›lady hakera w logach.</p>

        <div class="card">
            <h3>PRZYKÅAD: LOGI SKANOWANIA</h3>
            <div class="log-box">
                <span class="log-time">[12:00:01]</span> <span class="log-ip">192.168.1.5</span> GET /admin <span class="log-attack">403</span><br>
                <span class="log-time">[12:00:02]</span> <span class="log-ip">192.168.1.5</span> GET /backup <span class="log-attack">404</span><br>
                <span class="log-time">[12:00:02]</span> <span class="log-ip">192.168.1.5</span> GET /.env <span class="log-attack">200</span> <span style="color:red"><-- ALARM!</span>
            </div>
            <p><strong>Analiza:</strong> Widzisz szybkie Å¼Ä…dania z jednego IP, ktÃ³re generujÄ… bÅ‚Ä™dy (4xx). To rekonesans (Dirbuster/FFUF). Sukces (200) na pliku `.env` to incydent krytyczny.</p>
        </div>

        <div class="card">
            <h3>SIEM (Security Information and Event Management)</h3>
            <p>Nikt nie czyta logÃ³w rÄ™cznie. NarzÄ™dzia SIEM (np. Splunk, ELK) zbierajÄ… logi i automatycznie wykrywajÄ… anomalie (np. "UÅ¼ytkownik z Polski zalogowaÅ‚ siÄ™ 5 minut po nieudanym logowaniu z Chin").</p>
        </div>
    </section>

    <!-- 4. WAF BYPASS -->
    <section>
        <h2>> DLACZEGO WAF TO NIE WSZYSTKO?</h2>
        <p>WAF nie naprawia bÅ‚Ä™du, tylko go zasÅ‚ania. Hakerzy stosujÄ… techniki <strong>Ewazji (Evasion)</strong>.</p>
        <div class="card">
            <ul>
                <li><strong>Obfuscation:</strong> WAF blokuje `<script>`, ale przepuszcza `<<script>script>`.</li>
                <li><strong>IP Rotation:</strong> Haker uÅ¼ywa proxy, Å¼eby ominÄ…Ä‡ blokadÄ™ IP (Rate Limiting).</li>
                <li><strong>Direct Access:</strong> JeÅ›li WAF chroni domenÄ™ `firma.pl`, haker moÅ¼e znaleÅºÄ‡ bezpoÅ›rednie IP serwera (Origin Server) i uderzyÄ‡ tam, omijajÄ…c WAF (Cloudflare Bypass).</li>
            </ul>
        </div>
    </section>

    <!-- CHECKLIST -->
    <section>
        <h2>BLUE TEAM CHECKLIST ğŸ›¡ï¸</h2>
        <div class="card checklist-card">
            <div class="checklist-item">
                <span class="check-icon">ğŸ›¡ï¸</span>
                <div><strong>Rate Limiting:</strong> Czy masz wÅ‚Ä…czone limity zapytaÅ„? To zabija wiÄ™kszoÅ›Ä‡ automatÃ³w skanujÄ…cych.</div>
            </div>
            <div class="checklist-item">
                <span class="check-icon">ğŸ›¡ï¸</span>
                <div><strong>Blokowanie Origin:</strong> Skonfiguruj serwer tak, by przyjmowaÅ‚ poÅ‚Ä…czenia TYLKO z adresÃ³w IP Twojego WAF-a (np. Cloudflare), a odrzucaÅ‚ resztÄ™ internetu.</div>
            </div>
            <div class="checklist-item">
                <span class="check-icon">ğŸ›¡ï¸</span>
                <div><strong>Alarmy 5xx:</strong> NagÅ‚y wzrost bÅ‚Ä™dÃ³w 500 (Internal Server Error) czÄ™sto oznacza, Å¼e ktoÅ› testuje SQL Injection i "psuje" zapytania.</div>
            </div>
        </div>
    </section>

    <!-- QUIZ -->
    <section id="quiz-section">
        <h2>ğŸ“ WERYFIKACJA WIEDZY OBRONNEJ</h2>
        <div id="quiz-container"></div>
    </section>

    <footer>
        <p style="text-align: center; margin-top: 50px; color: #555;">&copy; 2026 Hack & Learn: Web Edition | ModuÅ‚ 27</p>
    </footer>
</div>

<!-- DANE DO QUIZU -->
<script>
    const quizData = [
        {
            question: "Czym rÃ³Å¼ni siÄ™ WAF (Web Application Firewall) od tradycyjnego Firewalla sieciowego?",
            options: [
                "WAF jest droÅ¼szy.",
                "Tradycyjny firewall dziaÅ‚a na warstwie sieci (IP/Porty), a WAF dziaÅ‚a na warstwie aplikacji (HTTP), rozumiejÄ…c i analizujÄ…c treÅ›Ä‡ zapytaÅ„ (SQL, XSS).",
                "WAF chroni tylko przed wirusami.",
                "Tradycyjny firewall blokuje WiFi."
            ],
            correct: 1,
            explanation: "ZwykÅ‚y firewall przepuÅ›ci atak SQL Injection, bo idzie on na dozwolony port 80. WAF zajrzy do Å›rodka pakietu, zobaczy 'SELECT *' i go zablokuje."
        },
        {
            question: "Co to jest 'Virtual Patching'?",
            options: [
                "Aktualizacja Windowsa.",
                "Tymczasowe zabezpieczenie aplikacji poprzez wdroÅ¼enie reguÅ‚y na WAF, ktÃ³ra blokuje prÃ³by wykorzystania znanej podatnoÅ›ci, zanim programiÅ›ci naprawiÄ… kod ÅºrÃ³dÅ‚owy.",
                "Instalacja gry wirtualnej.",
                "Naprawa sprzÄ™tu zdalnie."
            ],
            correct: 1,
            explanation: "To kluczowa strategia w korporacjach. Pozwala natychmiast 'zatkaÄ‡ dziurÄ™' na produkcji, dajÄ…c deweloperom czas na przygotowanie poprawki w kodzie."
        },
        {
            type: "scenario",
            question: "Widzisz w logach: 1000 zapytaÅ„ na sekundÄ™ z jednego adresu IP, kaÅ¼de celuje w inny plik (admin.php, login.php, test.php) i koÅ„czy siÄ™ bÅ‚Ä™dem 404. Co siÄ™ dzieje?",
            options: [
                "To normalny ruch uÅ¼ytkownikÃ³w.",
                "To atak typu Fuzzing/Directory Busting (automatyczny rekonesans). AtakujÄ…cy szuka ukrytych zasobÃ³w.",
                "Serwer siÄ™ zepsuÅ‚.",
                "To indeksowanie przez Google."
            ],
            correct: 1,
            explanation: "Taki wzorzec (duÅ¼o requestÃ³w, duÅ¼o 404, jedno IP) to sygnatura narzÄ™dzi typu Dirb, Gobuster czy FFUF."
        },
        {
            question: "Dlaczego samo posiadanie WAF nie gwarantuje bezpieczeÅ„stwa?",
            options: [
                "Bo WAF zuÅ¼ywa duÅ¼o prÄ…du.",
                "PoniewaÅ¼ WAF dziaÅ‚a w oparciu o reguÅ‚y, ktÃ³re moÅ¼na ominÄ…Ä‡ (Bypass/Ewazja), a takÅ¼e nie chroni przed bÅ‚Ä™dami logiki biznesowej (np. IDOR).",
                "Bo WAF dziaÅ‚a tylko w dzieÅ„.",
                "Bo WAF nie chroni przed DDoS."
            ],
            correct: 1,
            explanation: "WAF to tylko sito. Sprytny haker znajdzie sposÃ³b, by przeÅ›lizgnÄ…Ä‡ siÄ™ przez oczka (np. inne kodowanie znakÃ³w). Ponadto WAF nie wie, czy Jan powinien mieÄ‡ dostÄ™p do faktury Marka (IDOR)."
        },
        {
            question: "Co to jest 'False Positive' w kontekÅ›cie WAF?",
            options: [
                "Pozytywny wynik testu na wirusa.",
                "Sytuacja, gdy WAF blokuje legalnego uÅ¼ytkownika, uznajÄ…c jego dziaÅ‚anie za atak (np. blokuje przesyÅ‚anie kodu SQL w tutorialu programistycznym).",
                "Niewykrycie ataku.",
                "BÅ‚Ä…d logowania."
            ],
            correct: 1,
            explanation: "To zmora administratorÃ³w. Zbyt restrykcyjny WAF moÅ¼e zablokowaÄ‡ klientÃ³w sklepu. Dlatego strojenie (Tuning) WAF jest tak waÅ¼ne."
        },
        {
            type: "scenario",
            question: "Twoja firma uÅ¼ywa Cloudflare (WAF). AtakujÄ…cy poznaÅ‚ jednak prawdziwy adres IP Twojego serwera (Origin IP). Jakie jest ryzyko?",
            options: [
                "Å»adne.",
                "Krytyczne. AtakujÄ…cy moÅ¼e poÅ‚Ä…czyÄ‡ siÄ™ bezpoÅ›rednio z Twoim serwerem, caÅ‚kowicie omijajÄ…c ochronÄ™ Cloudflare (Cloudflare Bypass).",
                "MoÅ¼e zmieniÄ‡ DNS.",
                "MoÅ¼e wykraÅ›Ä‡ certyfikat."
            ],
            correct: 1,
            explanation: "To czÄ™sty bÅ‚Ä…d konfiguracyjny. Serwer powinien byÄ‡ skonfigurowany tak, aby odrzucaÄ‡ (DROP) wszelki ruch, ktÃ³ry NIE pochodzi z adresÃ³w IP Cloudflare."
        }
    ];
</script>

<script src="quiz.js"></script>

</body>
</html>