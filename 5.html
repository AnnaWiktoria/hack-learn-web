<!DOCTYPE html>
<html lang="pl">

<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="AnnaWiktoria">
    <meta name="copyright" content="AnnaWiktoria">
    <meta name="description" content="Interaktywny kurs bezpieczeÅ„stwa aplikacji webowych. Licencja CC BY-NC-SA.">

    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; 
               style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
               font-src 'self' https://fonts.gstatic.com; 
               script-src 'self' 'unsafe-inline'; 
               img-src 'self' data:;">

    <title>Kurs bezpieczeÅ„stwa aplikacji webowych -Lekcja 05: SOP & CORS</title>

    <link rel="stylesheet" href="style.css">

    <style>
        /* Akcent: Neon Orange (Boundaries/Firewalls) */
        :root {
            --accent: #ff6d00;
            --accent-glow: rgba(255, 109, 0, 0.3);
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <h1>SOP & CORS</h1>
            <p>MODUÅ 05: Granice Internetu i Wyciek Danych Cross-Origin</p>
        </header>

        <!-- 1. SOP - PRAWO -->
        <section>
            <h2>> SOP (SAME-ORIGIN POLICY)</h2>
            <p>SOP to najwaÅ¼niejsza reguÅ‚a bezpieczeÅ„stwa w przeglÄ…darce. To "Wielki Mur", ktÃ³ry oddziela strony od
                siebie.</p>

            <div class="card">
                <h3>ZASADA DZIAÅANIA</h3>
                <p>Skrypt z domeny <code>A.com</code> <strong>nie moÅ¼e odczytaÄ‡</strong> danych z domeny
                    <code>B.com</code>, chyba Å¼e domena B wyraÅºnie na to pozwoli.</p>
                <p>Gdyby SOP nie istniaÅ‚, wchodzÄ…c na <code>smieszne-koty.pl</code>, skrypt JS na tej stronie mÃ³gÅ‚by
                    odczytaÄ‡ Twoje maile z otwartej w tle karty <code>gmail.com</code>.</p>
            </div>

            <div class="card">
                <h3>CO TO JEST "ORIGIN"?</h3>
                <p>Dwie strony majÄ… ten sam "Origin" (pochodzenie) tylko wtedy, gdy zgadzajÄ… siÄ™ 3 elementy:</p>
                <ol>
                    <li><strong>ProtokÃ³Å‚</strong> (np. https)</li>
                    <li><strong>Domena</strong> (np. bank.com)</li>
                    <li><strong>Port</strong> (np. 443)</li>
                </ol>
            </div>

            <table>
                <thead>
                    <tr>
                        <th colspan="2">PorÃ³wnanie z: <span style="color:#fff">https://bank.com</span></th>
                    </tr>
                    <tr>
                        <th>Adres URL</th>
                        <th>Wynik SOP</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>https://bank.com/konto</code></td>
                        <td><span class="secure">SAME ORIGIN</span> (Zgodne)</td>
                    </tr>
                    <tr>
                        <td><code>http://bank.com</code></td>
                        <td><span class="status-badge s-5xx">CROSS ORIGIN</span> (Inny protokÃ³Å‚)</td>
                    </tr>
                    <tr>
                        <td><code>https://api.bank.com</code></td>
                        <td><span class="status-badge s-5xx">CROSS ORIGIN</span> (Inna subdomena)</td>
                    </tr>
                    <tr>
                        <td><code>https://bank.com:8080</code></td>
                        <td><span class="status-badge s-5xx">CROSS ORIGIN</span> (Inny port)</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- 2. CORS - WYJÄ„TEK -->
        <section>
            <h2>> CORS (CROSS-ORIGIN RESOURCE SHARING)</h2>
            <p>Czasami <code>frontend.com</code> MUSI pobraÄ‡ dane z <code>api.backend.com</code>. SOP na to nie pozwala.
                Wtedy wkracza CORS.</p>
            <p>CORS to system "wizowy". Serwer API wysyÅ‚a nagÅ‚Ã³wki mÃ³wiÄ…ce przeglÄ…darce: <br><em>"Spoko, pozwalam
                    domenie frontend.com czytaÄ‡ moje dane"</em>.</p>

            <div class="card">
                <h3>KLUCZOWE NAGÅÃ“WKI (ODPOWIEDÅ¹ SERWERA)</h3>
                <ul>
                    <li><code>Access-Control-Allow-Origin: https://zaufana.com</code> <br>
                        Tylko ta jedna domena moÅ¼e czytaÄ‡ odpowiedÅº.</li>

                    <li><code>Access-Control-Allow-Credentials: true</code> <br>
                        Pozwala przesyÅ‚aÄ‡ ciasteczka (sesjÄ™) w zapytaniu Cross-Origin. <strong>Krytyczne dla
                            bezpieczeÅ„stwa.</strong></li>
                </ul>
            </div>
        </section>

        <!-- 3. ATAKI -->
        <section>
            <h2>> BÅÄ˜DY KONFIGURACJI CORS</h2>
            <p>Pentesterzy szukajÄ… sytuacji, w ktÃ³rych serwer jest "zbyt miÅ‚y" i pozwala czytaÄ‡ dane atakujÄ…cemu.</p>

            <div class="card">
                <h3>SCENARIUSZ 1: REFLECTED ORIGIN (Odbicie lustrzane)</h3>
                <p>Programista byÅ‚ leniwy i napisaÅ‚ skrypt, ktÃ³ry kopiuje nagÅ‚Ã³wek <code>Origin</code> z Å¼Ä…dania do
                    nagÅ‚Ã³wka <code>Access-Control-Allow-Origin</code> w odpowiedzi.</p>

                <pre><code><span class="comment"># Å»Ä…danie atakujÄ…cego (zÅ‚oÅ›liwa strona)</span>
GET /api/private-data HTTP/1.1
Host: bank.com
Origin: https://evil-hacker.com

<span class="comment"># OdpowiedÅº serwera (BÅÄ„D!)</span>
HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://evil-hacker.com
Access-Control-Allow-Credentials: true</code></pre>

                <p><strong>Skutek:</strong> Haker moÅ¼e stworzyÄ‡ stronÄ™, ktÃ³ra w tle odpyta bank ofiary, a przeglÄ…darka
                    pozwoli hakerowi odczytaÄ‡ saldo konta (bo serwer na to "zezwoliÅ‚").</p>
            </div>

            <div class="card">
                <h3>SCENARIUSZ 2: WILDCARD Z CREDENTIALS</h3>
                <p>Konfiguracja:</p>
                <pre><code>Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true</code></pre>
                <p>To teoretycznie "Å›wiÄ™ty graal", ale nowoczesne przeglÄ…darki <strong>blokujÄ…</strong> takie
                    poÅ‚Ä…czenie. Nie moÅ¼na uÅ¼ywaÄ‡ gwiazdki (<code>*</code>) razem z <code>true</code>. Jednak czÄ™sto
                    zdarza siÄ™ w starych aplikacjach lub narzÄ™dziach mobilnych.</p>
            </div>

            <div class="card">
                <h3>SCENARIUSZ 3: NULL ORIGIN</h3>
                <p>NiektÃ³re serwery blokujÄ… obce domeny, ale pozwalajÄ… na <code>null</code>. AtakujÄ…cy moÅ¼e uÅ¼yÄ‡
                    sandboxed iframe: <code>&lt;iframe sandbox="allow-scripts ...</code>, ktÃ³ry wysyÅ‚a Å¼Ä…danie z
                    <code>Origin: null</code>. JeÅ›li serwer to akceptuje -> Wyciek danych.</p>
            </div>
        </section>

        <!-- CHECKLIST -->
        <section>
            <h2>CHECKLISTA / RED FLAGS</h2>
            <div class="card checklist-card">
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>Reflected Origin:</strong> ZmieÅ„ nagÅ‚Ã³wek <code>Origin</code> w Burp Suite na
                        <code>evil.com</code>. JeÅ›li serwer odpowie <code>Allowed: evil.com</code> -> ZgÅ‚oÅ› to!</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>Credentials: true:</strong> JeÅ›li serwer pozwala na `Credentials: true` przy luÅºnym
                        Origin, moÅ¼na ukraÅ›Ä‡ dane zalogowanego uÅ¼ytkownika.</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">âš </span>
                    <div><strong>Regex na domenach:</strong> ProgramiÅ›ci czÄ™sto uÅ¼ywajÄ… sÅ‚abych wyraÅ¼eÅ„ regularnych. Np.
                        pozwalajÄ… na `bank.com`, ale przez pomyÅ‚kÄ™ wpuszczajÄ… teÅ¼ `bank.com.evil.com`.</div>
                </div>
            </div>
        </section>

        <!-- QUIZ -->
        <section id="quiz-section">
            <h2>ğŸ“ WERYFIKACJA WIEDZY</h2>
            <div id="quiz-container"></div>
        </section>
<footer>
            <p style="text-align: center; margin-top: 50px; color: #555;">&copy; 2026 Hack & Learn: Web Edition | ModuÅ‚
                05</p>
        </footer>
    </div>

    <!-- DANE DO QUIZU -->
    <script>
        const quizData = [
            {
                question: "Co skÅ‚ada siÄ™ na definicjÄ™ 'Origin' (Pochodzenia)?",
                options: [
                    "Tylko domena (np. google.com).",
                    "Domena i adres IP.",
                    "ProtokÃ³Å‚, Domena i Port.",
                    "Kraj pochodzenia serwera."
                ],
                correct: 2,
                explanation: "Aby dwa adresy byÅ‚y 'Same Origin', muszÄ… mieÄ‡ ten sam protokÃ³Å‚ (http/https), tÄ™ samÄ… domenÄ™ i ten sam port."
            },
            {
                question: "Co domyÅ›lnie blokuje SOP (Same-Origin Policy)?",
                options: [
                    "WysyÅ‚anie Å¼Ä…daÅ„ do innego serwera.",
                    "Odczytywanie odpowiedzi z innego serwera przez skrypty JS.",
                    "Åadowanie obrazkÃ³w z innego serwera.",
                    "UÅ¼ywanie CSS z innego serwera."
                ],
                correct: 1,
                explanation: "To kluczowe rozrÃ³Å¼nienie: SOP zazwyczaj pozwala WYSYÅAÄ† Å¼Ä…dania (dlatego dziaÅ‚a CSRF), ale zabrania ODCZYTYWAÄ† odpowiedzi (dlatego chroni dane przed wyciekiem)."
            },
            {
                type: "scenario",
                question: "Testujesz API. W odpowiedzi widzisz nagÅ‚Ã³wek 'Access-Control-Allow-Origin: *'. Czy to zawsze jest bÅ‚Ä…d?",
                options: [
                    "Tak, to zawsze krytyczna podatnoÅ›Ä‡.",
                    "Nie. JeÅ›li API udostÄ™pnia dane publiczne (np. prognozÄ™ pogody) i nie wymaga logowania, to jest to poprawne.",
                    "Tak, przeglÄ…darki tego nie obsÅ‚ugujÄ….",
                    "ZaleÅ¼y od wersji Apache."
                ],
                correct: 1,
                explanation: "Gwiazdka (*) jest bezpieczna TYLKO dla danych publicznych. JeÅ›li endpoint zwraca dane prywatne, musi wymagaÄ‡ uwierzytelnienia, a wtedy gwiazdka jest zabroniona."
            },
            {
                type: "scenario",
                question: "WysyÅ‚asz Å¼Ä…danie z nagÅ‚Ã³wkiem 'Origin: https://hacker.com'. Serwer odpowiada: 'Access-Control-Allow-Origin: https://hacker.com' oraz 'Access-Control-Allow-Credentials: true'. Co to oznacza?",
                options: [
                    "Serwer jest dobrze zabezpieczony.",
                    "To podatnoÅ›Ä‡ 'CORS Misconfiguration'. MoÅ¼esz stworzyÄ‡ stronÄ™, ktÃ³ra ukradnie dane zalogowanego uÅ¼ytkownika.",
                    "To bÅ‚Ä…d 500.",
                    "To atak SQL Injection."
                ],
                correct: 1,
                explanation: "To klasyczny przykÅ‚ad 'Reflected Origin'. Serwer Å›lepo ufa temu, co wyÅ›lesz w nagÅ‚Ã³wku Origin i pozwala Twojej domenie na dostÄ™p do ciasteczek (Credentials)."
            },
            {
                question: "Do czego sÅ‚uÅ¼y Å¼Ä…danie 'Preflight' (metoda OPTIONS) w CORS?",
                options: [
                    "Do sprawdzenia, czy serwer dziaÅ‚a.",
                    "PrzeglÄ…darka wysyÅ‚a je automatycznie przed wÅ‚aÅ›ciwym Å¼Ä…daniem (np. PUT/DELETE lub z customowymi nagÅ‚Ã³wkami), aby zapytaÄ‡ serwer o zgodÄ™.",
                    "SÅ‚uÅ¼y do kasowania cache.",
                    "To wirus."
                ],
                correct: 1,
                explanation: "ZÅ‚oÅ¼one Å¼Ä…dania (np. JSON z Content-Type application/json) wymagajÄ… zgody serwera PRZED wysÅ‚aniem wÅ‚aÅ›ciwych danych. PrzeglÄ…darka robi to sama."
            },
            {
                question: "Czy 'http://example.com' i 'https://example.com' to ten sam Origin?",
                options: [
                    "Tak, domena jest ta sama.",
                    "Nie, rÃ³Å¼niÄ… siÄ™ protokoÅ‚em.",
                    "Tak, jeÅ›li port jest ten sam.",
                    "ZaleÅ¼y od przeglÄ…darki."
                ],
                correct: 1,
                explanation: "ProtokÃ³Å‚ jest czÄ™Å›ciÄ… definicji Origin. HTTP i HTTPS sÄ… traktowane jako dwa rÃ³Å¼ne Å›wiaty."
            },
            {
                question: "Co oznacza nagÅ‚Ã³wek 'Access-Control-Allow-Credentials: true'?",
                options: [
                    "Zezwala na dostÄ™p do kamery.",
                    "Pozwala na wysyÅ‚anie hasÅ‚a w URL.",
                    "Pozwala przeglÄ…darce doÅ‚Ä…czyÄ‡ ciasteczka (sesjÄ™) i nagÅ‚Ã³wki autoryzacyjne do Å¼Ä…dania Cross-Origin.",
                    "Wymusza zmianÄ™ hasÅ‚a."
                ],
                correct: 2,
                explanation: "Bez tego nagÅ‚Ã³wka, nawet jeÅ›li serwer pozwoli na dostÄ™p domenowy, przeglÄ…darka nie wyÅ›le ciasteczek sesyjnych, wiÄ™c Å¼Ä…danie bÄ™dzie anonimowe."
            },
            {
                type: "scenario",
                question: "Programista pozwoliÅ‚ na dostÄ™p CORS dla domeny `bank.com`. AtakujÄ…cy zarejestrowaÅ‚ domenÄ™ `bank.com.evil.com`. JeÅ›li serwer uÅ¼ywa sÅ‚abego regexa, czy atak siÄ™ uda?",
                options: [
                    "Nie, SOP to zablokuje.",
                    "Tak, jeÅ›li regex sprawdza tylko czy ciÄ…g zawiera 'bank.com' lub koÅ„czy siÄ™ na nim w niewÅ‚aÅ›ciwy sposÃ³b.",
                    "Nie, DNS to zablokuje.",
                    "Tylko w Internet Explorerze."
                ],
                correct: 1,
                explanation: "BÅ‚Ä™dy parsowania Origin sÄ… czÄ™ste. Regex typu `Origin.endsWith('bank.com')` przepuÅ›ci `evilbank.com` lub `bank.com.hacker.site`."
            },
            {
                question: "Jaka jest relacja miÄ™dzy SOP a XSS?",
                options: [
                    "SOP chroni przed XSS.",
                    "XSS pozwala obejÅ›Ä‡ SOP. Skrypt wstrzykniÄ™ty przez XSS wykonuje siÄ™ w kontekÅ›cie domeny ofiary ('Same Origin'), wiÄ™c ma dostÄ™p do wszystkiego.",
                    "Nie majÄ… ze sobÄ… nic wspÃ³lnego.",
                    "SOP blokuje XSS."
                ],
                correct: 1,
                explanation: "To jest sedno sprawy! XSS jest tak groÅºny, bo 'oszukuje' przeglÄ…darkÄ™. Skrypt hakera dziaÅ‚a JAKO strona banku, wiÄ™c SOP go nie blokuje."
            },
            {
                question: "Kiedy przeglÄ…darka blokuje dostÄ™p do odpowiedzi przy bÅ‚Ä™dzie CORS?",
                options: [
                    "Å»Ä…danie w ogÃ³le nie wychodzi z przeglÄ…darki.",
                    "Å»Ä…danie jest wysyÅ‚ane, serwer je przetwarza i odpowiada, ale przeglÄ…darka UKRYWA treÅ›Ä‡ odpowiedzi przed skryptem JS.",
                    "Serwer odrzuca poÅ‚Ä…czenie.",
                    "Komputer siÄ™ wyÅ‚Ä…cza."
                ],
                correct: 1,
                explanation: "WaÅ¼ne dla pentesterÃ³w: BÅ‚Ä…d CORS w konsoli nie oznacza, Å¼e request nie dotarÅ‚. CzÄ™sto akcja na serwerze siÄ™ wykonaÅ‚a (np. przelew), ale JS nie zobaczyÅ‚ potwierdzenia."
            }
        ];
    </script>

    <script src="quiz.js"></script>

</body>


</html>
