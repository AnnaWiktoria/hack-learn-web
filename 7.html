<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lekcja 07: JWT - Kurs Pentestera</title>

    <link rel="stylesheet" href="style.css">

    <style>
        /* Akcent: Cyber Gold (Tokens/Keys) */
        :root {
            --accent: #ffd600;
            --accent-glow: rgba(255, 214, 0, 0.3);
        }

        /* Kolory do wizualizacji JWT */
        .jwt-header {
            color: #fb015b;
        }

        /* Czerwony */
        .jwt-payload {
            color: #d63aff;
        }

        /* Fioletowy */
        .jwt-sig {
            color: #00b9f1;
        }

        /* Niebieski */
    </style>
</head>

<body>

    <div class="container">
        <header>
            <h1>JSON WEB TOKENS</h1>
            <p>MODU≈Å 07: Anatomia tokena, Algorytm 'None' i ≈Åamanie podpis√≥w</p>
        </header>

        <!-- 1. ANATOMIA -->
        <section>
            <h2>> ANATOMIA JWT</h2>
            <p>JWT to nie jest "losowy ciƒÖg znak√≥w". To ustrukturyzowany format danych (JSON), zakodowany w Base64Url i
                podpisany cyfrowo.</p>

            <div class="card">
                <h3>STRUKTURA: AAAAA.BBBBB.CCCCC</h3>
                <p>Token sk≈Çada siƒô z 3 czƒô≈õci rozdzielonych kropkami:</p>
                <div
                    style="background:#111; padding:15px; border-radius:5px; font-family:monospace; word-break:break-all; font-size:1.1rem;">
                    <span class="jwt-header">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span>.<span
                        class="jwt-payload">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ</span>.<span
                        class="jwt-sig">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span>
                </div>
                <ul>
                    <li><strong class="jwt-header">1. HEADER (Czerwony):</strong> Metadane. M√≥wi "Jestem JWT i u≈ºywam
                        algorytmu HS256".</li>
                    <li><strong class="jwt-payload">2. PAYLOAD (Fioletowy):</strong> Dane u≈ºytkownika (Claims). Tu jest
                        ID, rola, data wa≈ºno≈õci.</li>
                    <li><strong class="jwt-sig">3. SIGNATURE (Niebieski):</strong> Podpis cyfrowy. Gwarantuje, ≈ºe nikt
                        nie zmieni≈Ç Payloadu.</li>
                </ul>
            </div>

            <div class="card">
                <h3>BASE64 != SZYFROWANIE</h3>
                <p>To najwa≈ºniejsza rzecz do zapamiƒôtania. <strong>Ka≈ºdy mo≈ºe odczytaƒá tre≈õƒá JWT.</strong> Wystarczy
                    wrzuciƒá go do <code>jwt.io</code> lub u≈ºyƒá <code>base64 -d</code>.</p>
                <p><span class="highlight">Wniosek:</span> Nigdy nie trzymaj hase≈Ç ani danych wra≈ºliwych w Payloadzie!
                </p>
            </div>
        </section>

        <!-- 2. JAK TO DZIA≈ÅA -->
        <section>
            <h2>> MECHANIZM PODPISU</h2>
            <p>Skoro ka≈ºdy mo≈ºe edytowaƒá Base64, dlaczego nie mogƒô zmieniƒá sobie <code>"admin": false</code> na
                <code>true</code>?</p>
            <p>Bo serwer sprawdza <strong>PODPIS (Signature)</strong>.</p>
            <pre><code>Signature = HMACSHA256(
  base64(Header) + "." + base64(Payload),
  SECRET_KEY
)</code></pre>
            <p>Je≈õli zmienisz choƒá jeden znak w Payloadzie, podpis przestanie pasowaƒá (bo nie znasz
                <code>SECRET_KEY</code>, ≈ºeby wygenerowaƒá nowy). Serwer odrzuci taki token.</p>
        </section>

        <!-- 3. ATAKI -->
        <section>
            <h2>> ATAKI NA JWT</h2>
            <p>Co mo≈ºe p√≥j≈õƒá nie tak? Ca≈Çkiem sporo.</p>

            <div class="card">
                <h3>1. ALGORITHM: NONE (Obej≈õcie podpisu)</h3>
                <p>Niekt√≥re biblioteki JWT wspierajƒÖ algorytm <code>none</code> (u≈ºywany do debugowania).</p>
                <p><strong>Atak:</strong>
                <ol>
                    <li>Bierzesz token.</li>
                    <li>Zmieniasz w Headerze: <code>"alg": "none"</code>.</li>
                    <li>Zmieniasz w Payloadzie: <code>"role": "admin"</code>.</li>
                    <li>Usuwasz podpis (zostawiasz kropkƒô na ko≈Ñcu).</li>
                    <li>Wysy≈Çasz do serwera. Je≈õli backend jest ≈∫le skonfigurowany -> Jeste≈õ adminem.</li>
                </ol>
                </p>
            </div>

            <div class="card">
                <h3>2. WEAK SECRET (≈Åamanie HMAC)</h3>
                <p>Je≈õli programista u≈ºy≈Ç s≈Çabego sekretu (np. "secret", "12345", "key"), mo≈ºesz go z≈Çamaƒá offline
                    u≈ºywajƒÖc <strong>Hashcat</strong> lub <strong>John the Ripper</strong>.</p>
                <p>Gdy poznasz sekret, mo≈ºesz generowaƒá w≈Çasne, poprawne tokeny dla dowolnego u≈ºytkownika.</p>
            </div>

            <div class="card">
                <h3>3. BRAK WERYFIKACJI PODPISU</h3>
                <p>Najg≈Çupszy b≈ÇƒÖd, ale siƒô zdarza. Serwer dekoduje Payload, ufa mu, ale... zapomina sprawdziƒá
                    Signature. Wtedy mo≈ºesz wpisaƒá tam cokolwiek.</p>
            </div>
        </section>

        <!-- CHECKLIST -->
        <section>
            <h2>CHECKLISTA / RED FLAGS</h2>
            <div class="card checklist-card">
                <div class="checklist-item">
                    <span class="check-icon">‚ö†</span>
                    <div><strong>Wra≈ºliwe dane w Payload:</strong> PESEL, adresy, numery telefon√≥w w Base64. To wyciek
                        danych (Information Disclosure).</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">‚ö†</span>
                    <div><strong>Algorytm 'None':</strong> Zawsze sprawdzaj, czy serwer przyjmie token z wy≈ÇƒÖczonym
                        podpisywaniem.</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">‚ö†</span>
                    <div><strong>Brak daty wa≈ºno≈õci (exp):</strong> Token, kt√≥ry nigdy nie wygasa, jest niebezpieczny.
                        Je≈õli kto≈õ go ukradnie, ma dostƒôp na zawsze.</div>
                </div>
                <div class="checklist-item">
                    <span class="check-icon">‚ö†</span>
                    <div><strong>Token w LocalStorage:</strong> JWT trzymany w LocalStorage jest podatny na kradzie≈º
                        przez XSS (tak jak ciastka bez HttpOnly).</div>
                </div>
            </div>
        </section>

        <!-- QUIZ -->
        <section id="quiz-section">
            <h2>üéì WERYFIKACJA WIEDZY</h2>
            <div id="quiz-container"></div>
        </section>

        <footer>
            <p style="text-align: center; margin-top: 50px; color: #555;">&copy; 2026 Kurs Pentestera | Modu≈Ç 07</p>
        </footer>
    </div>

    <!-- DANE DO QUIZU -->
    <script>
        const quizData = [
            {
                question: "Z ilu czƒô≈õci sk≈Çada siƒô token JWT i czym sƒÖ rozdzielone?",
                options: [
                    "Z dw√≥ch czƒô≈õci rozdzielonych my≈õlnikiem.",
                    "Z trzech czƒô≈õci rozdzielonych kropkƒÖ (Header.Payload.Signature).",
                    "To jeden ciƒÖg znak√≥w zaszyfrowany AES.",
                    "Z nag≈Ç√≥wka i cia≈Ça, jak HTML."
                ],
                correct: 1,
                explanation: "Struktura to AAAAA.BBBBB.CCCCC. Pierwsza czƒô≈õƒá to nag≈Ç√≥wek, druga to dane (payload), trzecia to podpis cyfrowy."
            },
            {
                question: "Czy dane w sekcji Payload (≈õrodek tokena) sƒÖ zaszyfrowane?",
                options: [
                    "Tak, sƒÖ bezpieczne i nikt ich nie odczyta.",
                    "Nie. SƒÖ tylko zakodowane w Base64Url. Ka≈ºdy mo≈ºe je odkodowaƒá i przeczytaƒá.",
                    "Tak, ale tylko serwer ma klucz.",
                    "Zale≈ºy od przeglƒÖdarki."
                ],
                correct: 1,
                explanation: "To kluczowe dla pentestera. Base64 to kodowanie (jak t≈Çumaczenie na inny jƒôzyk), a nie szyfrowanie. Wrzuƒá token do jwt.io, a zobaczysz wszystko."
            },
            {
                type: "scenario",
                question: "Przechwyci≈Çe≈õ token JWT. Zmieniasz w nim 'user_id' z 100 na 1 (admin), ale nie ruszasz podpisu. Wysy≈Çasz go do serwera. Co siƒô stanie (w poprawnie zabezpieczonym systemie)?",
                options: [
                    "Serwer zaakceptuje token i da Ci uprawnienia admina.",
                    "Serwer odrzuci token, poniewa≈º podpis nie bƒôdzie pasowa≈Ç do zmienionego Payloadu.",
                    "Serwer naprawi podpis automatycznie.",
                    "WystƒÖpi b≈ÇƒÖd 500."
                ],
                correct: 1,
                explanation: "Podpis jest matematycznƒÖ sumƒÖ orygina≈Çu. Zmiana danych sprawia, ≈ºe stary podpis staje siƒô niewa≈ºny. Bez sekretnego klucza nie wygenerujesz nowego, poprawnego podpisu."
            },
            {
                question: "Na czym polega atak 'None Algorithm'?",
                options: [
                    "Na wys≈Çaniu pustego tokena.",
                    "Na zmianie nag≈Ç√≥wka tokena na {'alg': 'none'} i usuniƒôciu podpisu, liczƒÖc na to, ≈ºe serwer pominie weryfikacjƒô.",
                    "Na usuniƒôciu Payloadu.",
                    "Na ataku DDoS."
                ],
                correct: 1,
                explanation: "To b≈ÇƒÖd implementacji w niekt√≥rych bibliotekach. Je≈õli serwer widzi 'alg: none', mo≈ºe uznaƒá: 'Aha, ten token nie wymaga podpisu' i zaufaƒá danym."
            },
            {
                question: "Do czego s≈Çu≈ºy pole 'exp' (Expiration Time) w JWT?",
                options: [
                    "Okre≈õla datƒô wa≈ºno≈õci tokena. Po tym czasie serwer powinien go odrzuciƒá.",
                    "To skr√≥t od 'export'.",
                    "Zawiera has≈Ço u≈ºytkownika.",
                    "Okre≈õla poziom do≈õwiadczenia (experience) w grze."
                ],
                correct: 0,
                explanation: "Tokeny JWT (zazwyczaj) nie mogƒÖ byƒá uniewa≈ºnione (revoked) przed czasem. Dlatego 'exp' powinien byƒá kr√≥tki (np. 15 min), aby zminimalizowaƒá ryzyko w razie kradzie≈ºy."
            },
            {
                type: "scenario",
                question: "Znalaz≈Çe≈õ token JWT, kt√≥ry w Payloadzie zawiera: 'eyJlbWFpbCI6ImphbkBmaXJtYS5wbCIsInBlc2VsIjoiOTAwMTAx...'. Dekodujesz go i widzisz numery PESEL. Jakie to ryzyko?",
                options: [
                    "Critical - Wyciek danych osobowych (Information Disclosure).",
                    "Low - Base64 jest bezpieczny.",
                    "None - To normalna praktyka.",
                    "Medium - Tylko je≈õli PESEL jest prawdziwy."
                ],
                correct: 0,
                explanation: "Przechowywanie danych wra≈ºliwych (PII) w JWT to b≈ÇƒÖd. Tokeny czƒôsto lƒÖdujƒÖ w logach serwera, historii przeglƒÖdarki lub LocalStorage, gdzie sƒÖ ≈Çatwo dostƒôpne."
            },
            {
                question: "W jaki spos√≥b mo≈ºna z≈Çamaƒá podpis JWT (HS256) offline?",
                options: [
                    "Nie da siƒô, to niemo≈ºliwe.",
                    "U≈ºywajƒÖc narzƒôdzi typu Hashcat/John the Ripper do ataku s≈Çownikowego (brute-force) na sekretny klucz.",
                    "Wysy≈ÇajƒÖc milion zapyta≈Ñ do serwera.",
                    "ZmieniajƒÖc datƒô w systemie."
                ],
                correct: 1,
                explanation: "Je≈õli klucz (Secret) jest s≈Çaby (np. 'secret123'), haker mo≈ºe na swoim superkomputerze sprawdzaƒá miliony kombinacji na sekundƒô, a≈º znajdzie tƒô, kt√≥ra pasuje do podpisu."
            },
            {
                type: "scenario",
                question: "Dlaczego trzymanie JWT w LocalStorage jest uwa≈ºane za ryzykowne?",
                options: [
                    "Bo zajmuje du≈ºo miejsca.",
                    "Bo ka≈ºdy kod JavaScript (w tym ten wstrzykniƒôty przez XSS) ma dostƒôp do LocalStorage i mo≈ºe ukra≈õƒá token.",
                    "Bo LocalStorage kasuje siƒô po restarcie komputera.",
                    "Bo nie dzia≈Ça w trybie Incognito."
                ],
                correct: 1,
                explanation: "To g≈Ç√≥wna wada JWT na frontendzie. Ciasteczka `HttpOnly` sƒÖ chronione przed XSS. LocalStorage jest otwarte dla ka≈ºdego skryptu JS."
            },
            {
                question: "Co to jest 'alg' w nag≈Ç√≥wku JWT?",
                options: [
                    "Algorytm u≈ºyty do podpisania tokena (np. HS256, RS256).",
                    "Algebraiczna suma kontrolna.",
                    "Skr√≥t od 'algorithm' oznaczajƒÖcy szyfrowanie danych.",
                    "Nazwa u≈ºytkownika (alias)."
                ],
                correct: 0,
                explanation: "Nag≈Ç√≥wek m√≥wi serwerowi: 'U≈ºyj algorytmu X, aby sprawdziƒá m√≥j podpis'. Ataki polegajƒÖ czƒôsto na manipulacji tym polem (None attack, Algo Confusion)."
            },
            {
                type: "scenario",
                question: "Serwer u≈ºywa asymetrycznego RS256 (Klucz prywatny do podpisu, publiczny do weryfikacji). AtakujƒÖcy zmienia w tokenie algorytm na symetryczny HS256 i podpisuje token KLUCZEM PUBLICZNYM (kt√≥ry jest jawny). Serwer to akceptuje. Co to za atak?",
                options: [
                    "SQL Injection.",
                    "Key Confusion / Algorithm Confusion Attack.",
                    "Brute Force.",
                    "Man in the Middle."
                ],
                correct: 1,
                explanation: "To zaawansowany i piƒôkny atak. Serwer my≈õli: 'Mam zweryfikowaƒá HS256? Ok, u≈ºyjƒô mojego klucza'. Ale w RS256 kluczem weryfikujƒÖcym jest plik publiczny. AtakujƒÖcy wymusi≈Ç u≈ºycie klucza publicznego jako 'sekretu' HMAC."
            }
        ];
    </script>

    <script src="quiz.js"></script>

</body>

</html>